# DNS协议

# 一、域名

【定义】

它是由字母、数字和连字符组成的字符串，用于代替 IP 地址，以方便用户记忆。

用户向域名注册商

【域名的结构】

域名的结构是分层次的，从右到左依次包括顶级域（Top-Level Domain，TLD）、二级域、三级域，依此类推。

> 例如，在 “www.example.com" 中，".com" 是顶级域，"example" 是二级域，"www" 是三级域。
> 

【常见顶级域名】

- 以下是一些常见的顶级域名及其一般意义：
    1. **.com**（商业）：最常见的商业顶级域名，通常用于商业网站。
    2. **.org**（组织）：通常用于非盈利组织，但也可由其他组织和个人注册。
    3. **.net**（网络）：最初是为网络服务提供商设计的，但现在任何人都可以注册。
    4. **.gov**（政府）：用于美国政府机构。
    5. **.edu**（教育）：用于美国教育机构，如大学和学术机构。
    6. **.mil**（军事）：用于美国军方。
    7. **.int**（国际组织）：用于国际组织，如联合国。
    8. **.cn**（中国）：国家代码顶级域名，用于中国。
    9. **.jp**（日本）：国家代码顶级域名，用于日本。
    10. **.uk**（英国）：国家代码顶级域名，用于英国。
    11. **.info**（信息）：通常被用于提供信息性内容的网站。
    12. **.biz**（商业）：用于商业目的，但比较少见。
    13. **.tv**（电视）：常用于与电视相关的网站。
    14. **.me**（个人）：通常被用于个人网站。
    15. **.co**（公司）：常被认为是公司的缩写，也广泛用于商业网站。

【其他】

- 其他域名相关知识点：
    
    ![Untitled](DNS%E5%8D%8F%E8%AE%AE%20019c57229b844452bf0556f0de753070/Untitled.png)
    

# 二、URL&URI

【定义-URL】

URL即“统一资源定位器”，包括以下内容：

协议、目标域名&ip、端口、文件&服务路径

传参（以?开始，以&分隔多传参）

片段标识符（以#开始将当前定位到网页中的某个片段位置）

示例：`https://www.example.com:8080/path/to/resource?param1=value1&param2=value2#section2`

【定义-URI】

URI即“统一资源标识符”，是一个抽象的概念，只要是一个符号能表示对某个特定资源的标识，它就是一种URI。

URL也是一种URI。

# 三、域名系统（DNS）

【定义】

即Domain Name System，DNS。

是用于将域名映射到 IP 地址的分布式数据库系统，计算机可以通过DNS查询来获得某个域名对应的IP。

> DNS系统也提供了将IP地址解析成域名的“反向解析”服务
> 

【DNS查询过程】

当用户在浏览器中输入一个域名时，计算机首先会查询本地 DNS 缓存（又叫“本地域名服务器”）。倘无果，则向远端 DNS 服务器发起请求，以获取域名对应的 IP 地址。

向 DNS 服务器发起请求的过程，可以分为递归查询和递归与迭代相结合查询，如下：

- **递归查询：**
    
    1、请求报文给到根域名服务器，尝试获得IP地址
    
    2、若1失败，则根域名服务器将请求报文给到顶级域名服务器，尝试获得IP地址
    
    3、若2失败，则顶级域名服务器将请求报文给到次级域名服务器，尝试获得IP地址
    
    4、依次类推，直到最终获取到目标域名的 IP 地址，响应报文根据请求报文的传递路径传回主机
    
    ![Untitled](DNS%E5%8D%8F%E8%AE%AE%20019c57229b844452bf0556f0de753070/Untitled%201.png)
    
- **递归与迭代结合查询（常用）：**
    
    1、请求报文给到根域名服务器，其将顶级域名服务器地址给到“本地域名服务器”程序
    
    2、程序按照地址请求报文给到顶级域名服务器，其将次级域名服务器地址给到“本地域名服务器”程序
    
    3、以此类推，直到请求获得ip地址结果
    
    ![Untitled](DNS%E5%8D%8F%E8%AE%AE%20019c57229b844452bf0556f0de753070/Untitled%202.png)
    

# 四、DNS报文格式

其报文格式基于UDP，分为：查询报文和响应报文。

### 1-DNS查询报文：

DNS查询报文通常包含以下字段：

1. **Header（报头）：** 包含一些控制和标识信息，如查询类型、查询类别、是否递归等。
2. **Question（问题）：** 包含查询的域名以及相关的查询类型和查询类别。

### 2-DNS响应报文：

DNS响应报文通常包含以下字段：

1. **Header（报头）：** 包含一些控制和标识信息，如响应码、是否支持递归等。
2. **Question（问题）：** 包含查询的域名以及相关的查询类型和查询类别。
3. **Answer（回答）：** 包含对查询的回答，可能包括目标域名的IP地址等信息。
4. **Authority（权威）：** 包含权威服务器的信息，它是一个包含有关查询域的授权信息的区域。
5. **Additional（附加）：** 包含一些附加信息，例如额外的资源记录。