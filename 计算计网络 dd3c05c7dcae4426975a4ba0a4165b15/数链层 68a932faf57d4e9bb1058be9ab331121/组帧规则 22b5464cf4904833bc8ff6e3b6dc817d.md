# 组帧规则

# 一、相关基本概念

**帧：**

帧是数链层的基本数据单元

**组帧：**

将一段数据（来自网络层的分片）的前后分别放入有控制信息意义的首部和尾部（这一操作叫“组帧”），就构成了一帧。所以一帧的结构如下：

`帧头-数据部分-帧尾`

**帧定界&帧同步：**

发送方通过头部和尾部来确定一帧信息的前后界，叫做帧定界；

如果接收方能够识别出一帧的首部尾部信息，就叫做帧同步。

**最大传送单元（MTU）&最小帧长：**

最小帧长由CSMA-CD协议中的`x>2τ`公式推导出来，是64B。

MTU则表示了最大帧长（不计帧头帧尾），由物理介质和网络设备性能推导出来，是1500B。

# 二、如何防止截断（透明传输）

透明传输是一种思想，即：我们希望不管是什么样的信息都可以传。换句话说就是不会出现因为传输的数据中有人和帧头帧尾“撞衫”而导致传输事故。

为了实现这一思想，有两种实现思路：

1.转义字符

2.保留字符

# 三、**标准帧格式规定（4种）**

> 他们的设计目的是使目标机器能够识别出帧的开始和结尾，这就需要特殊字符。
> 
> 
> 但因为没有考虑保留字符，所以要使用转义字符方式来避免截断。
> 

【组帧过程】

因为来自网络层的数据包大小不会超过MTU，所以这里的组帧过程便直接为数据包加上包头包尾即可。

【格式】

以下是5种标准帧格式规定详细：

- **1-字符计数法**
    
    【定义】
    
    直接不填充帧的尾部，而只在帧头部用一个计数字段来标明该帧的长度，这样读到计数字段的时，将该长度作为偏移可以快速得到帧的尾部地址。
    
    理论上效率更高，但是因为一旦计数字段出错“差之厘毫”会导致接收结果“溃之千里”，其鲁棒性太低，已被废除
    
- **2-字符填充法**
    
    【定义】
    
    历史上曾经的一种帧格式识别方式：用ASCII表中的控制字符SOH表示帧的开始，
    
    但是因为要转义来转义去实在太麻烦，现在已经不用了
    
- **3-零比特填充法（!!!）**
    
    【定义】
    
    用`01111110`表示开始和结束
    
    同时，发送方通过以下转义规则以防止数据被错误截断：
    
    `当出现连续的5个1时，在后面加个0`
    
    接收方进行该操作的逆操作
    
    【意义】
    
    实际证明这种方案比起原来的ASCII字符码方案效率更高，所以该方案是现役方案
    
- **4-违规编码法**
    
    【定义】
    
    用物理介质编码的违规编码来表示帧的开始&结束
    
    如：曼彻斯特编码下用“高-低”表示1，用“低-高”表示0→那就可以用违规的“高-高”表示帧头，“低-低”表示帧尾
    
    【意义】
    
    仅适用于有冗余编码的环境，反之，如果“高-低”“低-高”“高-高”“低-低”都有表示数据的意义了，那就没辙 
    
- 5-**HDLC标准帧格式（!!!）**
    
    这是现代比较广泛应用的组帧协议，内容如下：
    
    ![Untitled](%E7%BB%84%E5%B8%A7%E8%A7%84%E5%88%99%2022b5464cf4904833bc8ff6e3b6dc817d/Untitled.png)